<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>ğŸµ ì°¬ì–‘ëŒ€ íŠ¹ì†¡</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .card-gradient {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    }

    .header-gradient {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .animate-spin {
      animation: spin 1s linear infinite;
    }

    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }

    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    function App() {
      const [allSongs, setAllSongs] = useState([]);
      const [memos, setMemos] = useState({});
      const [loading, setLoading] = useState(true);
      const [progress, setProgress] = useState(0);
      const [error, setError] = useState(null);
      const [activeTab, setActiveTab] = useState('ì£¼ì¼ì°¬ì†¡');
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedDays, setSelectedDays] = useState([]);
      const [selectedCategories, setSelectedCategories] = useState([]);
      const [startDate, setStartDate] = useState('');
      const [endDate, setEndDate] = useState('');
      const [quickDate, setQuickDate] = useState('all');
      const [showAddModal, setShowAddModal] = useState(false);
      const [editingMemo, setEditingMemo] = useState(null);
      const [newSong, setNewSong] = useState({
        date: '',
        category: 'ì£¼ì¼ì°¬ì†¡',
        songName: '',
        team: '',
        accompanist: '',
        notes: ''
      });

      const tabs = ['ì£¼ì¼ì°¬ì†¡', 'íŠ¹ë³„ì§‘íšŒ', 'ì „ë„ì§‘íšŒ'];
      const weekDays = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
      const evangelismCategories = [
        'ì˜¤ì „ì§‘íšŒ', 'ëŒ€ì§‘íšŒ', 'ì¤‘ì§‘íšŒ', 'ì²­ë…„ì§‘íšŒ', 
        'êµêµ¬ì§‘íšŒ', 'ê¸°íƒ€ì§‘íšŒ', 'ì€ë¹›ì¥ë…„íšŒì§‘íšŒ'
      ];
      const allCategories = ['ì£¼ì¼ì°¬ì†¡', 'íŠ¹ë³„ì§‘íšŒ', ...evangelismCategories];

      useEffect(() => {
        loadData();
      }, []);

      const loadData = async () => {
        try {
          setProgress(10);
          const response = await fetch('data.json');
          if (!response.ok) throw new Error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨');
          
          setProgress(40);
          const jsonData = await response.json();
          
          setProgress(70);
          const songs = jsonData.map(item => ({
            id: `${item.date}_${item.title || item.songName}`,
            date: item.date,
            dayOfWeek: getDayOfWeek(item.date),
            songName: item.title || item.songName || '',
            category: item.category,
            team: item.type || item.team || '',
            accompanist: extractAccompanist(item.notes || ''),
            notes: cleanNotes(item.notes || ''),
            isCustom: false
          }));

          setProgress(90);
          
          const savedMemos = localStorage.getItem('songMemos');
          if (savedMemos) setMemos(JSON.parse(savedMemos));

          const customSongs = localStorage.getItem('customSongs');
          if (customSongs) {
            const custom = JSON.parse(customSongs);
            setAllSongs([...songs, ...custom.map(s => ({...s, isCustom: true}))]);
          } else {
            setAllSongs(songs);
          }

          setProgress(100);
          setLoading(false);
        } catch (err) {
          setError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          setLoading(false);
        }
      };

      const getDayOfWeek = (dateStr) => {
        const days = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
        return days[new Date(dateStr).getDay()];
      };

      const extractAccompanist = (notes) => {
        const match = notes.match(/ë°˜ì£¼:\s*([^,\n]+)/);
        return match ? match[1].trim() : '';
      };

      const cleanNotes = (notes) => {
        return notes.replace(/ë°˜ì£¼:\s*[^,\n]+,?\s*/, '').trim();
      };

      const filteredData = useMemo(() => {
        let filtered = allSongs;

        if (activeTab === 'ì£¼ì¼ì°¬ì†¡') {
          filtered = filtered.filter(item => item.category === 'ì£¼ì¼ì°¬ì†¡');
        } else if (activeTab === 'íŠ¹ë³„ì§‘íšŒ') {
          filtered = filtered.filter(item => item.category === 'íŠ¹ë³„ì§‘íšŒ');
        } else if (activeTab === 'ì „ë„ì§‘íšŒ') {
          filtered = filtered.filter(item => evangelismCategories.includes(item.category));
          
          if (selectedDays.length > 0) {
            filtered = filtered.filter(item => selectedDays.includes(item.dayOfWeek));
          }
          
          if (selectedCategories.length > 0) {
            filtered = filtered.filter(item => selectedCategories.includes(item.category));
          }
        }

        if (startDate) filtered = filtered.filter(item => item.date >= startDate);
        if (endDate) filtered = filtered.filter(item => item.date <= endDate);

        if (searchTerm) {
          const term = searchTerm.toLowerCase();
          filtered = filtered.filter(item => 
            (item.songName || '').toLowerCase().includes(term) ||
            (item.team || '').toLowerCase().includes(term) ||
            (item.accompanist || '').toLowerCase().includes(term) ||
            (item.notes || '').toLowerCase().includes(term)
          );
        }

        return filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
      }, [allSongs, activeTab, searchTerm, selectedDays, selectedCategories, startDate, endDate]);

      const handleAddSong = (e) => {
        e.preventDefault();
        
        if (!newSong.date || !newSong.songName) {
          alert('âš ï¸ ë‚ ì§œì™€ ê³¡ëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤!');
          return;
        }

        const songData = {
          id: `custom_${Date.now()}`,
          date: newSong.date,
          dayOfWeek: getDayOfWeek(newSong.date),
          songName: newSong.songName,
          category: newSong.category,
          team: newSong.team,
          accompanist: newSong.accompanist,
          notes: newSong.notes,
          isCustom: true
        };

        const updatedSongs = [...allSongs, songData];
        setAllSongs(updatedSongs);

        const customSongs = updatedSongs.filter(s => s.isCustom);
        localStorage.setItem('customSongs', JSON.stringify(customSongs));

        setNewSong({
          date: '',
          category: 'ì£¼ì¼ì°¬ì†¡',
          songName: '',
          team: '',
          accompanist: '',
          notes: ''
        });
        setShowAddModal(false);
        alert('âœ… íŠ¹ì†¡ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
      };

      const handleDeleteSong = (songId) => {
        if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

        const updatedSongs = allSongs.filter(song => song.id !== songId);
        setAllSongs(updatedSongs);

        const customSongs = updatedSongs.filter(s => s.isCustom);
        localStorage.setItem('customSongs', JSON.stringify(customSongs));
        alert('âœ… ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
      };

      const saveMemo = (songDate, songName, memoText) => {
        const key = `${songDate}_${songName}`;
        const updatedMemos = { ...memos, [key]: memoText };
        setMemos(updatedMemos);
        localStorage.setItem('songMemos', JSON.stringify(updatedMemos));
        setEditingMemo(null);
        alert('âœ… ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
      };

      const deleteMemo = (songDate, songName) => {
        if (!confirm('ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
        const key = `${songDate}_${songName}`;
        const updatedMemos = { ...memos };
        delete updatedMemos[key];
        setMemos(updatedMemos);
        localStorage.setItem('songMemos', JSON.stringify(updatedMemos));
        alert('âœ… ë©”ëª¨ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
      };

      const setQuickDateRange = (type) => {
        const today = new Date();
        let start, end;

        switch(type) {
          case 'all':
            setStartDate('');
            setEndDate('');
            break;
          case '1month':
            end = new Date();
            start = new Date(today.setMonth(today.getMonth() - 1));
            setStartDate(start.toISOString().split('T')[0]);
            setEndDate(end.toISOString().split('T')[0]);
            break;
          case '3months':
            end = new Date();
            start = new Date(today.setMonth(today.getMonth() - 3));
            setStartDate(start.toISOString().split('T')[0]);
            setEndDate(end.toISOString().split('T')[0]);
            break;
          case '1year':
            end = new Date();
            start = new Date(today.setFullYear(today.getFullYear() - 1));
            setStartDate(start.toISOString().split('T')[0]);
            setEndDate(end.toISOString().split('T')[0]);
            break;
          case 'thisyear':
            const year = new Date().getFullYear();
            setStartDate(`${year}-01-01`);
            setEndDate(`${year}-12-31`);
            break;
        }
        setQuickDate(type);
      };

      const exportToExcel = () => {
        const exportData = filteredData.map(item => ({
          'ë‚ ì§œ': item.date,
          'ìš”ì¼': item.dayOfWeek,
          'ê³¡ëª…': item.songName,
          'ì¹´í…Œê³ ë¦¬': item.category,
          'íŒ€': item.team,
          'ë°˜ì£¼ì': item.accompanist,
          'ë¹„ê³ ': item.notes
        }));

        const ws = XLSX.utils.json_to_sheet(exportData);
        ws['!cols'] = [
          { wch: 12 }, { wch: 6 }, { wch: 30 },
          { wch: 15 }, { wch: 20 }, { wch: 12 }, { wch: 30 }
        ];

        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'íŠ¹ì†¡ëª©ë¡');

        const today = new Date().toISOString().split('T')[0].replace(/-/g, '');
        XLSX.writeFile(wb, `íŠ¹ì†¡ëª©ë¡_${activeTab}_${today}.xlsx`);
        alert(`âœ… ${filteredData.length}ê°œ í•­ëª©ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`);
      };

      const toggleDay = (day) => {
        setSelectedDays(prev => 
          prev.includes(day) ? prev.filter(d => d !== day) : [...prev, day]
        );
      };

      const toggleCategory = (cat) => {
        setSelectedCategories(prev => 
          prev.includes(cat) ? prev.filter(c => c !== cat) : [...prev, cat]
        );
      };

      const getMemoKey = (item) => `${item.date}_${item.songName}`;

      if (loading) {
        return (
          <div className="min-h-screen flex flex-col items-center justify-center p-4">
            <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full">
              <div className="text-center">
                <div className="text-6xl mb-6 animate-spin">
                  <i className="fas fa-circle-notch text-purple-600"></i>
                </div>
                <h2 className="text-2xl font-bold text-gray-800 mb-4">
                  ğŸµ ì°¬ì–‘ëŒ€ íŠ¹ì†¡ ê´€ë¦¬
                </h2>
                <div className="w-full bg-gray-200 rounded-full h-3 mb-4">
                  <div 
                    className="bg-gradient-to-r from-purple-600 to-pink-600 h-3 rounded-full transition-all duration-300"
                    style={{width: `${progress}%`}}
                  ></div>
                </div>
                <p className="text-lg font-semibold text-purple-600">{progress}%</p>
                <p className="text-gray-600 mt-2">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
              </div>
            </div>
          </div>
        );
      }

      if (error) {
        return (
          <div className="min-h-screen flex items-center justify-center p-4">
            <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center">
              <div className="text-6xl mb-4">âš ï¸</div>
              <h2 className="text-2xl font-bold text-red-600 mb-4">ì˜¤ë¥˜ ë°œìƒ</h2>
              <p className="text-gray-700 mb-6">{error}</p>
              <button 
                onClick={() => window.location.reload()}
                className="bg-purple-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-purple-700 active:scale-95 transition"
              >
                ë‹¤ì‹œ ì‹œë„
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen pb-24">
          {/* Header */}
          <div className="header-gradient text-white sticky top-0 z-50 shadow-lg">
            <div className="max-w-7xl mx-auto px-4 py-6">
              <h1 className="text-3xl md:text-4xl font-bold text-center mb-2">
                ğŸµ ì°¬ì–‘ëŒ€ íŠ¹ì†¡ ê´€ë¦¬
              </h1>
              <p className="text-center text-sm md:text-base opacity-90">
                ì´ <span className="font-bold text-lg">{allSongs.length}</span>ê°œ íŠ¹ì†¡
              </p>
            </div>
          </div>

          <div className="max-w-7xl mx-auto px-4 py-6">
            {/* Tabs */}
            <div className="flex gap-2 mb-6 overflow-x-auto scrollbar-hide pb-2">
              {tabs.map(tab => (
                <button
                  key={tab}
                  onClick={() => setActiveTab(tab)}
                  className={`px-6 py-3 rounded-full font-semibold whitespace-nowrap transition-all active:scale-95 ${
                    activeTab === tab
                      ? 'bg-purple-600 text-white shadow-lg'
                      : 'bg-white text-gray-700 hover:bg-gray-100'
                  }`}
                >
                  {tab}
                </button>
              ))}
            </div>

            {/* Search */}
            <div className="mb-6">
              <div className="relative">
                <input
                  type="text"
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  placeholder="ğŸ” ê³¡ëª…, íŒ€, ë°˜ì£¼ì ê²€ìƒ‰..."
                  className="w-full px-6 py-4 text-lg rounded-2xl border-2 border-gray-200 focus:border-purple-500 focus:outline-none transition"
                />
              </div>
            </div>

            {/* Date Range */}
            <div className="bg-white rounded-2xl p-6 mb-6 shadow-sm">
              <h3 className="font-bold text-gray-800 mb-4 text-lg">ğŸ“… ë‚ ì§œ ë²”ìœ„</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label className="block text-sm font-semibold text-gray-700 mb-2">ì‹œì‘ì¼</label>
                  <input
                    type="date"
                    value={startDate}
                    onChange={(e) => {
                      setStartDate(e.target.value);
                      setQuickDate('');
                    }}
                    className="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold text-gray-700 mb-2">ì¢…ë£Œì¼</label>
                  <input
                    type="date"
                    value={endDate}
                    onChange={(e) => {
                      setEndDate(e.target.value);
                      setQuickDate('');
                    }}
                    className="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-purple-500 focus:outline-none"
                  />
                </div>
              </div>
              <div className="flex flex-wrap gap-2">
                {['all', '1month', '3months', '1year', 'thisyear'].map(type => {
                  const labels = {
                    all: 'ì „ì²´',
                    '1month': 'ìµœê·¼ 1ê°œì›”',
                    '3months': 'ìµœê·¼ 3ê°œì›”',
                    '1year': 'ìµœê·¼ 1ë…„',
                    thisyear: 'ì˜¬í•´'
                  };
                  return (
                    <button
                      key={type}
                      onClick={() => setQuickDateRange(type)}
                      className={`px-4 py-2 rounded-full text-sm font-semibold transition active:scale-95 ${
                        quickDate === type
                          ? 'bg-purple-600 text-white'
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                    >
                      {labels[type]}
                    </button>
                  );
                })}
              </div>
            </div>

            {/* Filters for ì „ë„ì§‘íšŒ */}
            {activeTab === 'ì „ë„ì§‘íšŒ' && (
              <div className="bg-white rounded-2xl p-6 mb-6 shadow-sm">
                <h3 className="font-bold text-gray-800 mb-4 text-lg">ğŸ“… ìš”ì¼ í•„í„°</h3>
                <div className="flex flex-wrap gap-2 mb-6">
                  {weekDays.map(day => (
                    <button
                      key={day}
                      onClick={() => toggleDay(day)}
                      className={`px-4 py-2 rounded-full font-semibold transition active:scale-95 ${
                        selectedDays.includes(day)
                          ? 'bg-purple-600 text-white'
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                    >
                      {day}
                    </button>
                  ))}
                </div>

                <h3 className="font-bold text-gray-800 mb-4 text-lg">ğŸ“ ì¹´í…Œê³ ë¦¬ í•„í„°</h3>
                <div className="flex flex-wrap gap-2 mb-4">
                  {evangelismCategories.map(cat => (
                    <button
                      key={cat}
                      onClick={() => toggleCategory(cat)}
                      className={`px-4 py-2 rounded-full font-semibold transition active:scale-95 text-sm ${
                        selectedCategories.includes(cat)
                          ? 'bg-purple-600 text-white'
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                    >
                      {cat}
                    </button>
                  ))}
                </div>

                {(selectedDays.length > 0 || selectedCategories.length > 0) && (
                  <button
                    onClick={() => {
                      setSelectedDays([]);
                      setSelectedCategories([]);
                    }}
                    className="bg-red-500 text-white px-4 py-2 rounded-full font-semibold hover:bg-red-600 active:scale-95 transition"
                  >
                    <i className="fas fa-times mr-2"></i>
                    í•„í„° ì´ˆê¸°í™”
                  </button>
                )}
              </div>
            )}

            {/* Results Count */}
            <div className="mb-6">
              <p className="text-lg text-gray-700">
                ê²€ìƒ‰ ê²°ê³¼: <span className="text-2xl font-bold text-purple-600">{filteredData.length}</span>ê°œ
              </p>
            </div>

            {/* Results Grid */}
            {filteredData.length === 0 ? (
              <div className="text-center py-20">
                <div className="text-6xl mb-4">ğŸ”</div>
                <p className="text-xl text-gray-600">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>
              </div>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {filteredData.map((item, index) => {
                  const memoKey = getMemoKey(item);
                  const hasMemo = memos[memoKey];
                  const isEditingThis = editingMemo === memoKey;

                  return (
                    <div key={item.id || index} className="bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition-all">
                      {/* Card Header */}
                      <div className="flex justify-between items-start mb-4">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-2">
                            <i className="far fa-calendar-alt text-purple-600"></i>
                            <span className="font-bold text-purple-600 text-lg">
                              {item.date} ({item.dayOfWeek})
                            </span>
                          </div>
                          {item.isCustom && (
                            <span className="inline-block bg-orange-500 text-white text-xs px-3 py-1 rounded-full font-semibold">
                              ë‚´ê°€ ì¶”ê°€
                            </span>
                          )}
                          {hasMemo && (
                            <span className="inline-block bg-green-500 text-white text-xs px-3 py-1 rounded-full font-semibold ml-2">
                              ğŸ“ ë©”ëª¨
                            </span>
                          )}
                        </div>
                        <span className="bg-purple-600 text-white text-sm px-3 py-1 rounded-full font-semibold whitespace-nowrap">
                          {item.category}
                        </span>
                      </div>

                      {/* Song Name */}
                      <h3 className="text-2xl font-bold text-gray-800 mb-4 break-words">
                        {item.songName}
                      </h3>

                      {/* Details */}
                      <div className="space-y-3 mb-4">
                        {item.team && (
                          <div className="flex items-start gap-3">
                            <i className="fas fa-users text-purple-600 mt-1"></i>
                            <span className="text-gray-700 flex-1">{item.team}</span>
                          </div>
                        )}
                        {item.accompanist && (
                          <div className="flex items-start gap-3">
                            <i className="fas fa-music text-purple-600 mt-1"></i>
                            <span className="text-gray-700 flex-1">ë°˜ì£¼: {item.accompanist}</span>
                          </div>
                        )}
                        {item.notes && (
                          <div className="flex items-start gap-3">
                            <i className="fas fa-info-circle text-purple-600 mt-1"></i>
                            <span className="text-gray-700 flex-1">{item.notes}</span>
                          </div>
                        )}
                      </div>

                      {/* Delete Button */}
                      {item.isCustom && (
                        <button
                          onClick={() => handleDeleteSong(item.id)}
                          className="w-full bg-red-500 text-white py-3 rounded-xl font-semibold hover:bg-red-600 active:scale-95 transition mb-4"
                        >
                          <i className="fas fa-trash mr-2"></i>
                          ì‚­ì œ
                        </button>
                      )}

                      {/* Memo Section */}
                      <div className="bg-blue-50 rounded-xl p-4 border-l-4 border-purple-600">
                        <div className="flex justify-between items-center mb-3">
                          <span className="font-bold text-purple-600">ğŸ“ ë©”ëª¨</span>
                          <div className="flex gap-2">
                            {!isEditingThis && !hasMemo && (
                              <button
                                onClick={() => setEditingMemo(memoKey)}
                                className="bg-purple-600 text-white px-3 py-1 rounded-lg text-sm font-semibold hover:bg-purple-700 active:scale-95 transition"
                              >
                                ì¶”ê°€
                              </button>
                            )}
                            {!isEditingThis && hasMemo && (
                              <>
                                <button
                                  onClick={() => setEditingMemo(memoKey)}
                                  className="bg-purple-600 text-white px-3 py-1 rounded-lg text-sm font-semibold hover:bg-purple-700 active:scale-95 transition"
                                >
                                  ìˆ˜ì •
                                </button>
                                <button
                                  onClick={() => deleteMemo(item.date, item.songName)}
                                  className="bg-red-500 text-white px-3 py-1 rounded-lg text-sm font-semibold hover:bg-red-600 active:scale-95 transition"
                                >
                                  ì‚­ì œ
                                </button>
                              </>
                            )}
                          </div>
                        </div>

                        {isEditingThis ? (
                          <div>
                            <textarea
                              defaultValue={memos[memoKey] || ''}
                              placeholder="ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                              id={`memo-${index}`}
                              className="w-full px-3 py-2 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none mb-2 min-h-[80px]"
                            />
                            <div className="flex gap-2">
                              <button
                                onClick={() => {
                                  const text = document.getElementById(`memo-${index}`).value;
                                  if (text.trim()) {
                                    saveMemo(item.date, item.songName, text);
                                  } else {
                                    alert('ë©”ëª¨ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                                  }
                                }}
                                className="flex-1 bg-green-500 text-white py-2 rounded-lg font-semibold hover:bg-green-600 active:scale-95 transition"
                              >
                                ì €ì¥
                              </button>
                              <button
                                onClick={() => setEditingMemo(null)}
                                className="flex-1 bg-gray-400 text-white py-2 rounded-lg font-semibold hover:bg-gray-500 active:scale-95 transition"
                              >
                                ì·¨ì†Œ
                              </button>
                            </div>
                          </div>
                        ) : (
                          <p className="text-gray-700 whitespace-pre-wrap break-words">
                            {hasMemo ? memos[memoKey] : 'ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤'}
                          </p>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>

          {/* Bottom Buttons */}
          <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg z-50">
            <div className="max-w-7xl mx-auto flex gap-3">
              <button
                onClick={() => setShowAddModal(true)}
                className="flex-1 bg-purple-600 text-white py-4 rounded-2xl font-bold text-lg hover:bg-purple-700 active:scale-95 transition shadow-lg"
              >
                <i className="fas fa-plus mr-2"></i>
                íŠ¹ì†¡ ì¶”ê°€
              </button>
              <button
                onClick={exportToExcel}
                className="flex-1 bg-green-600 text-white py-4 rounded-2xl font-bold text-lg hover:bg-green-700 active:scale-95 transition shadow-lg"
              >
                <i className="fas fa-file-excel mr-2"></i>
                ì—‘ì…€
              </button>
            </div>
          </div>

          {/* Add Modal */}
          {showAddModal && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={() => setShowAddModal(false)}>
              <div className="bg-white rounded-3xl p-6 md:p-8 max-w-md w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                <div className="flex justify-between items-center mb-6">
                  <h2 className="text-2xl font-bold text-gray-800">â• ìƒˆ íŠ¹ì†¡ ì¶”ê°€</h2>
                  <button
                    onClick={() => setShowAddModal(false)}
                    className="text-gray-400 hover:text-gray-600 text-2xl"
                  >
                    <i className="fas fa-times"></i>
                  </button>
                </div>

                <form onSubmit={handleAddSong} className="space-y-4">
                  <div>
                    <label className="block font-bold text-gray-700 mb-2">ë‚ ì§œ *</label>
                    <input
                      type="date"
                      value={newSong.date}
                      onChange={(e) => setNewSong({...newSong, date: e.target.value})}
                      required
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none"
                    />
                  </div>

                  <div>
                    <label className="block font-bold text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬ *</label>
                    <select
                      value={newSong.category}
                      onChange={(e) => setNewSong({...newSong, category: e.target.value})}
                      required
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none"
                    >
                      {allCategories.map(cat => (
                        <option key={cat} value={cat}>{cat}</option>
                      ))}
                    </select>
                  </div>

                  <div>
                    <label className="block font-bold text-gray-700 mb-2">ê³¡ëª… *</label>
                    <input
                      type="text"
                      value={newSong.songName}
                      onChange={(e) => setNewSong({...newSong, songName: e.target.value})}
                      placeholder="ì˜ˆ: ì£¼ë‹˜ì˜ ì€í˜œ"
                      required
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none"
                    />
                  </div>

                  <div>
                    <label className="block font-bold text-gray-700 mb-2">íŒ€</label>
                    <input
                      type="text"
                      value={newSong.team}
                      onChange={(e) => setNewSong({...newSong, team: e.target.value})}
                      placeholder="ì˜ˆ: ì—˜ë¦¼ ì°¬ì–‘ë‹¨"
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none"
                    />
                  </div>

                  <div>
                    <label className="block font-bold text-gray-700 mb-2">ë°˜ì£¼ì</label>
                    <input
                      type="text"
                      value={newSong.accompanist}
                      onChange={(e) => setNewSong({...newSong, accompanist: e.target.value})}
                      placeholder="ì˜ˆ: ê¹€ì£¼ì€"
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none"
                    />
                  </div>

                  <div>
                    <label className="block font-bold text-gray-700 mb-2">ë¹„ê³ </label>
                    <textarea
                      value={newSong.notes}
                      onChange={(e) => setNewSong({...newSong, notes: e.target.value})}
                      placeholder="ì˜ˆ: ì¸ì›: 30ëª…"
                      className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none min-h-[100px]"
                    />
                  </div>

                  <div className="flex gap-3 pt-4">
                    <button
                      type="button"
                      onClick={() => setShowAddModal(false)}
                      className="flex-1 bg-gray-200 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-300 active:scale-95 transition"
                    >
                      ì·¨ì†Œ
                    </button>
                    <button
                      type="submit"
                      className="flex-1 bg-purple-600 text-white py-3 rounded-xl font-bold hover:bg-purple-700 active:scale-95 transition"
                    >
                      ì¶”ê°€í•˜ê¸°
                    </button>
                  </div>
                </form>
              </div>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
